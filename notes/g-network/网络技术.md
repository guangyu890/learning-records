# 网络技术

* 目标。日常网络运维。
* 重点。交换机配置。
* 参考。bilibili、博客园等。

## 一、常见的网络拓扑结构

* 总线型。串联的方式，有一根总干线，总线带宽决定了传输的速率。
* 星型。围绕一个点一线四周，所有的设置连接到一个中心点。
* 树型。多节星型结构。
* 环型。环绕圆形。运营商使用的多，
* 网型。成网状，四个点封闭。天然有备份，任意两点之间都会有一个直接连接。

***

## 二、局域网特点和常用设备

（一）特点

* 距离短。
* 延尺小。
* 传输速率高。
* 传输可靠。

（二）常用设备。

* HUB。(现几乎不用)
* 交换机。
* 路由器。
* 防火墙。

***网线最多能走100米左右，而且输效果最好。***

***

网络世界的规则：有标准协议才能通信。

数据通信标准分为两类：事实的和法定的

事实标准：未经组织团体承认但是已在应用中被广泛使用和接受的就是事实标准。

法定标准：由官方认可的团体制定的标准称为法定标准。如符合国标GB

标准化组织

* 国标标准化组织（ISO）
* 电子电器工程师协会(IEEE)
* 美国国家标准局(ANSI)
* 电子工业协会（EIA / TIA）
* 国际电信联盟（ITU）
* INTERNET工程任务委员会（IETF）

***

## 三、IP网络基础

OSI参考模型。开放系统互连参考模型，实现工作分层，促进了标准化的工作。

其特点如下：

* 简化了相关的网络操作
* 提供设备间的兼容性和标准接口
* 促进标准化工作
* 结构上可以分隔
* 易天实现和维护

从下至上，1至3层为底层，负责网络数据传办理，5至7至为高层负责主机之间的数据传输。

* 第一层为物理层。比特流传输
* 第二层为数据链路层。提供介质方问、链路管理等。寻址，如MAC，光纤网线等传办理。
* 第三层为网络层。寻址和路由选择。
* 第四层为传输层。建立主机端到端连接
* 第五层会话层。建立、维护和管理会话。
* 第六层表示层。处理数据格式、数据加密等，
* 第七层应用层。提供应用程序间的通信，如UI使用。

***

## 四、TCP/IP协议栈

OSI                                     TCP/IP

应用层              

表示层                                   均对应应用层

会话层            VS 

传输层-----------------------------传输层                        

网络层-----------------------------网络层

数据链路层-----------------------数据链路层

物理层----------------------------物理层

TCP/IP的一些协议

应用层：HTTP、Telnet、FTP、TFTP

传输层：TCP/UDP

网络层：IP

数据链路层：Ethernet、PPP、802.3

物理层：行理接口。

TCP/IP模型的层间通信与数据封装。

(一)OSI参考模型各层的功能：

1. 物理层：物理层的主要任务是透明地传办理比特流。物理层不关心比特流的实际意义和结构，只是负责接收和传送比特流。物理层定义网络硬件的特性，包括使用什么样的传输介质以及与传输介质连接的接头等物理特性。典型规范代表：EIA/TIARS-232、EIA/TIARS-449、V.35、RJ-45等。传送信息所利用的物理传输介质并不在物量层之内而是在物理层之下。

2. 数据链路层：数据链路层的主要任是在两个相邻节点间的线路上无差错地传输以帧(Frame)为tran单位的数据，并要产生和识别帧边界。数据链路层还提供了差措控制与流量控制的方法，保证在物理线路上传输的数据无差错。数据链路层协议的代表有：PPP(点对点协议。Point-to-Ponit Protocol)、STP（Spanning Tree Protocol）、帧中继等。

3. 网络层：网络层的主要任务是进行路由选择，以确保数据分组(Packet)从发送端到达接收端，并在数据分组发生阻塞时进行拥塞控制。网络层还要解决异构网络的互连问题，以实现数据分组在不同类型的网络中传输。网络层协议的代表有：IP、IPX、OSPF(Open Shortest Path First开放最短路径优先协议)等。

4. 传输层：传输层的主要任务是为上一层进行通信的两个进程之间提供一个可靠的端到端服务，使传输层以上的各层不再关心信息传输的问题。传输层从会话层接收数据，形成报文（Message），并且在必要时将其分成若干分组，然后交给网络层进行传输。传输层协议的代表有：TCP、UDP(User Datagram Protocol用户数据包协议)、SPX等。

5. 会话层：会话层的主要任是针对远程访问进行管理（比如断点续传），包括会话管理、传输同步以及数据交换管理等。

6. 表示层：表示层的主要任务是用处理在多个通信系统之间交换信息的表示方式，包括数据格式的转换、数据加密与解密、数据压缩与恢复等。

7. 应用层：应用层的主要任务是为网络用户或应用程序提供各种服务，如文件传输、电子邮件、网络管理和远程登陆等。

   ![OSI参考模型中的数据传输过程](/home/ygy/Downloads/uTools_1605229317061.png)

数据发送从高层到底层，接收从底层到高层。两者相反，报文一层一层打包然后一层一层解封装。每一层不对都不能正确发送和接收数据，类拟于包裹邮寄。

（二）TCP/IP参考模型

1.   TCP/IP概述。TCP/IP标准由一系列的文档定义组成，这些文档定义描述了Internet的内部实现机制，以及各种网络服务或服务的定义，TCP/IP标准并不是由某个特定组织开发的，实际上是一些团体共同开发的，任何人都可以把自己的意见作为文档发布，但只有被认可的文档才能最终成为Internet标准。

   * TCP/IP协议栈。 ![各层功能及协议栈图片](/home/ygy/Downloads/uTools_1605233334314.png)
   * 主机-网络层。TCP/IP参考模型并没有真正定义这一部分，只是指出这一层上必须具有物理层和数据链路层的功能。本层包含了多种网络层协议，如以太网协议（etherent）、令牌环网协议(Token Ring)、分组交换网协议(X.25)等。
   * 互联层。它提供的是无连接的服务，主要负责将源主机的数据分组发送到目的主机。互联层的主要功能包括：处理来自传输层的分组发送请求，处理接收到的数据报文、进行流量控制与拥塞控制等。互联层上定义的主要协议包括：网际协议（IP）、Internet控制报文协议、地址解析协议(ARP)、反向地址解析协议（RARP--REVERSE ADDRESS  RESOLUTION PROTOCOL）等。
   * 传输层。与OSI参考模型的传输层类似，TCP/IP参考模型的传输层的主要功能是：1.使发送方主机和接收方主机上的对等实体可以进行会话。在传输层了定义了以下两个端到端的协议。传输控制协议和用户数据报协议（UDP）。TCP是一个面向连接的可靠传输协议，而UDP是一个面向无连接的不可靠传输协义。
   * 应用层。负责向用户提供一组常用的程序接口，包含了所有TCP/IP协义簇中的高层协议。如FTP、HTTP、DNS等。应用层协议一般可以分为3类：一类是依赖于面向连接的TCP;一类是依赖于无连接的UDP;还有一类则既依赖于TCP又依赖于UDP;

   （三）OSI参考模型与TCP/IP参考模型

   1. 两种模型的共同点。一是均采用了协议分层方法，将庞大且复杂的问题划分为若干个较容易处理的范围较小的问题；二是各协议层次的功能大体上相似，都存在网络层、传输层和应用层；三是两者都可以解决异构网络的互联，实现世界上不同厂家生产的计算机之间的通信；四是两者都是计算机通信的国际标准，虽然这种标准一个是OSI原则上是国际通用的，一个TCP/IP是当前工业界使用最多的；五是两者都能够提供面向连接和面向无连接的两种通信服务机制。

   2. 不同点。一是模型设计的差别；二是层数和层间调用关系不用；三是最初设计的差别；四是对可靠性的强调不同；五是标准的效率和性能上存在差别；五是市场应用和支持不同。

   3. 网络参考模型建议。OSI的七层协议体系结构既复杂又不适用，但其概念清楚；TCP/IP的协议得到了全世界的承认，但并没有一个完整的体系结构。因此在学习计算机体系结构时，可以采用一直折衷的办法，把OSI中的会话层和表示层去掉，从而形成一种原理结构，只有五层，称为五层参考模型。

      ***

      应用层

      传输层

      网络层

      数据链路层

      物理层

      ***

      补充点：

      * 网络协议。是为进行网络中的数据通信或数据交换而建立的规则、标准或约定。连网的计算机以及网络设备之间要进行数据与控制信息的成功传递就必须共同遵守的网络协议，网络协议主要由以下3个要素组成，即语法、语义、时序。
        * 语法。规定通信双方“如何讲”，即确定用户数据与控制信息的结构与格式。
        * 语义。规定通信双方准备“讲什么”，即需要发出何种控制信息，完成何种动作以及作出何种应答。
        * 时序。规定双方“何时进行通信”，即事件实现顺序的详细说明。

* 进制转换。
* ![Untitled](/home/ygy/Downloads/Untitled.jpg) 
* 根据IP地址和子网掩码求网络地址和广播地址。
  * 将IP地址和子网掩码换算为二进制，子网掩码连续全1是网络地址，后面是主机地址。
  * IP地址和子网掩码进行与运算，结果是网络地址（即主机号全0是网络地址）。
  * 将运算结果中的网络地址不变，主机地址变为1,结果是广播地址。
  * 地址范围就是含本网段内的所有主机。
  * 主机的数量是2的n次方减2。
  * 网络地址+1即为第一个主机地址，广播地址-1即为最后一个主机地址。
  * 地址范围：网络地址+1至广播地址-1。
  * 减2是因为主机不包括网络地址和广播地址。
* 根据每个网络的主机数量进行子网地址的规划和计算子网掩码
  * 比如一个子网有10台主机，那么对于这个子网需要的IP地址是：10+1+1+1 =13.加的第一个1是指这个网络连接时所需的网关地址，接着的两个1分别是指网络地址和广播地址。因为13小于16（16是2的4次方，所以主机位为4位）。即：11110000,所以子网掩码为：255.255.255.240.
  * 如果一个子网有14台主机，依然按具有16个地址空间的子网，而忘了给网关分配地址，变成了：14+1+1+1=17,17大于16,所以我们只能分配具有32个地址（2的5次方）空间的子网，11100000的子网掩码为：255.255.255.224。
* IP段/数字-如192.168.0.1/24是什么意思？
  * 后面这个数字标示了我们的网络号的位数，也就是子网掩码中前多少号为1.
  * 子网掩码中的1和0均为连接的。

## 五、以太网

1. 交换式以太网。在交换式以太网中，各用户结点独占通道，独享带宽，从根本上解决了网络带宽问题。交换式以太网则允许接入的多个结点间同时建立多条通信链路，同时进行数据通信，从而大大提高了网络的利用率。交换式以太网可以构造”虚拟网络（VLAN）“，并通过软件的方式来实现逻辑工作组的划分和管理。以太网交换技术是基于以太网的，它最大限度地保留了现有以太网的基础设施，从而有效地保护了用户的投入。
   * 工作原理。以太网交换机监测发送到每个端口的数据包，通过数据包中的有关信息（源结点的MAC地址，目的结点的MAC地址），在交换机的内部建立一张”端口——MAC地址“的映射表，当某个端口接收到数据包后，交换机会取出该包中目的结点的MAC地址，并通过映射表迅速地将包转发到相应的输出端口。
   * 数据交换方式。直接交换。交换机只要接收到数据包，便立即获取包的目的地址，转换成相应的交换机端口，将该数据包转发出云；存储转发。交换机把数据包全部接收到内部缓冲区中，并进行检验，一旦发现错误就通知源结点重新发送该包。无碎片转发。在接收到数据帧的前64安节后判断该帧的帧头字段是否正确，如果正确则转发出去。
2. 虚拟局域网VLAN。指网络上的节点按工作性质与需要所划分的若干个”逻辑工作组“，其节点组成不受物理位置的限制。同一逻辑工作组的成员不一定要连接在同一个物理网段上，当一个节点从一个逻辑工作组转移到另一个逻辑工作组时，只需简单地通过软件设定，碢不需要改变其在网络中的物理位置。![uTools_1605237534044](/home/ygy/Downloads/uTools_1605237534044.png)
   * 优点。一是控制网络风暴。可将交换机的某个交换端口划分到某个VLAN中，一个VLAN的广播风暴不会影响到其他VLAN的性能；确保网络的安全性。VLAN能限制个别用户的访问以及控制广播的大小和位置，甚至锁定某台设备的MAC地址。三是简化网络的管理。网络管理员能借助VLAN技术轻松地管理整个网络。网络管理员只需设置几条命令就能很快建立一个VLAN，并将分布在不同地方的用户设置到VLAN中。
   * VLAN的组网方法。
     * 使用交换机端口定义VLAN。VLAN从逻辑上把局域网交换机的端口号划分成不同的虚拟子网，各虚拟子网相对独立。用局域网交换机端口号划分VLAN成员是最通用的办法。但是纯粹用端口号定义VLAN时，不允许不同的VLAN包含相同的物理网段或交换机端口号。![uTools_1605238010904](/home/ygy/Downloads/uTools_1605238010904.png)
     * 用MAC地址定义。采用节点的MAC地址来定义VLAN的优点是，允许节点移动到网络的其他物理网段，而自动保持该节点原来的VLAN成员地位。用MAC地址定义VLAN的缺点是，要求所有用户在初始阶段必须配置到至少一个VLAN中，这在大规模的网络中很麻烦。
     * 用网络层地址定义。采用节点的网络层地址来定义VLAN具有独特的优点。首先，允许按照协议类型来组VLAN，这有利于组成基于服务或应用的VLAN。其次，用户可以随意移动工作站而无需重新配置网络地址，这种方法最大的缺点是网络性能差，因为检查网络层地址比检查MAC地址要花费时间。